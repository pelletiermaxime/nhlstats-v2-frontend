import{v as e,u as a,a as t,c as r}from"./server.mjs";const n={trailing:!0};function debounce(e,a=25,t={}){if(t={...n,...t},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let r,o,s,c,i=[];const applyFn=(a,r)=>(s=async function(e,a,t){return await e.apply(a,t)}(e,a,r),s.finally(()=>{if(s=null,t.trailing&&c&&!o){const e=applyFn(a,c);return c=null,e}}),s),debounced=function(...e){return t.trailing&&(c=e),s||new Promise(n=>{const s=!o&&t.leading;clearTimeout(o),o=setTimeout(()=>{o=null;const a=t.leading?r:applyFn(this,e);c=null;for(const e of i)e(a);i=[]},a),s?(r=applyFn(this,e),n(r)):i.push(n)})},_clearTimeout=e=>{e&&(clearTimeout(e),o=null)};return debounced.isPending=()=>!!o,debounced.cancel=()=>{_clearTimeout(o),i=[],c=null},debounced.flush=()=>{if(_clearTimeout(o),!c||s)return;const e=c;return c=null,applyFn(this,e)},debounced}e.defineComponent({name:"ServerPlaceholder",render:()=>e.createElementBlock("div")});const o=Symbol.for("nuxt:client-only");function useAsyncData(...n){const o="string"==typeof n[n.length-1]?n.pop():void 0;(function(e,a){if("string"==typeof e)return!1;if("object"==typeof e&&null!==e)return!1;if("function"==typeof e&&"function"==typeof a)return!1;return!0})(n[0],n[1])&&n.unshift(o);let[s,c,i={}]=n;const l=e.computed(()=>e.toValue(s));if("string"!=typeof l.value)throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if("function"!=typeof c)throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const u=a();function createInitialFetch(){const a={cause:"initial",dedupe:i.dedupe};return u._asyncData[l.value]?._init||(a.cachedData=i.getCachedData(l.value,u,{cause:"initial"}),u._asyncData[l.value]=function(a,t,n,o,s){a.payload._errors[t]??=void 0;const c=o.getCachedData!==getDefaultCachedData,i=n,l=o.deep?e.ref:e.shallowRef,u=void 0!==s,d=a.hook("app:data:refresh",async e=>{e&&!e.includes(t)||await f.execute({cause:"refresh:hook"})}),f={data:l(u?s:o.default()),pending:e.computed(()=>"pending"===f.status.value),error:e.toRef(a.payload._errors,t),status:e.shallowRef("idle"),execute:(...n)=>{const[s,c]=n,l=s&&void 0===c&&"object"==typeof s?s:{};if(a._asyncDataPromises[t]&&"defer"===(l.dedupe??o.dedupe))return a._asyncDataPromises[t];{const e="cachedData"in l?l.cachedData:o.getCachedData(t,a,{cause:l.cause??"refresh:manual"});if(void 0!==e)return a.payload.data[t]=f.data.value=e,f.error.value=void 0,f.status.value="success",Promise.resolve(e)}f._abortController&&f._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),f._abortController=new AbortController,f.status.value="pending";const u=new AbortController,d=new Promise((e,t)=>{try{const r=l.timeout??o.timeout,n=function(e,a,t){const r=e.filter(e=>!!e);if("number"==typeof t&&t>=0){const e=AbortSignal.timeout?.(t);e&&r.push(e)}if(AbortSignal.any)return AbortSignal.any(r);const n=new AbortController;for(const e of r)if(e.aborted){const a=e.reason??new DOMException("Aborted","AbortError");try{n.abort(a)}catch{n.abort()}return n.signal}const onAbort=()=>{const e=r.find(e=>e.aborted),a=e?.reason??new DOMException("Aborted","AbortError");try{n.abort(a)}catch{n.abort()}};for(const e of r)e.addEventListener?.("abort",onAbort,{once:!0,signal:a});return n.signal}([f._abortController?.signal,l?.signal],u.signal,r);if(n.aborted){const e=n.reason;return void t(e instanceof Error?e:new DOMException(String(e??"Aborted"),"AbortError"))}return n.addEventListener("abort",()=>{const e=n.reason;t(e instanceof Error?e:new DOMException(String(e??"Aborted"),"AbortError"))},{once:!0,signal:u.signal}),Promise.resolve(i(a,{signal:n})).then(e,t)}catch(e){t(e)}}).then(async e=>{let r=e;o.transform&&(r=await o.transform(e)),o.pick&&(r=function(e,a){const t={};for(const r of a)t[r]=e[r];return t}(r,o.pick)),a.payload.data[t]=r,f.data.value=r,f.error.value=void 0,f.status.value="success"}).catch(n=>a._asyncDataPromises[t]&&a._asyncDataPromises[t]!==d||f._abortController?.signal.aborted?a._asyncDataPromises[t]:"undefined"!=typeof DOMException&&n instanceof DOMException&&"AbortError"===n.name?(f.status.value="idle",a._asyncDataPromises[t]):(f.error.value=r(n),f.data.value=e.unref(o.default()),void(f.status.value="error"))).finally(()=>{u.abort(),delete a._asyncDataPromises[t]});return a._asyncDataPromises[t]=d,a._asyncDataPromises[t]},_execute:debounce((...e)=>f.execute(...e),0,{leading:!0}),_default:o.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{d(),a._asyncData[t]?._init&&(a._asyncData[t]._init=!1),c||e.nextTick(()=>{a._asyncData[t]?._init||(clearNuxtDataByKey(a,t),f.execute=()=>Promise.resolve())})}};return f}(u,l.value,c,i,a.cachedData)),()=>u._asyncData[l.value].execute(a)}i.server??=!0,i.default??=getDefault,i.getCachedData??=getDefaultCachedData,i.lazy??=!1,i.immediate??=!0,i.deep??=t.deep,i.dedupe??="cancel",i._functionName,u._asyncData[l.value];const d=createInitialFetch();u._asyncData[l.value]._deps++;if(!1!==i.server&&u.payload.serverRendered&&i.immediate){const a=d();e.getCurrentInstance()?e.onServerPrefetch(()=>a):u.hook("app:created",async()=>{await a})}const f={data:writableComputedRef(()=>u._asyncData[l.value]?.data),pending:writableComputedRef(()=>u._asyncData[l.value]?.pending),status:writableComputedRef(()=>u._asyncData[l.value]?.status),error:writableComputedRef(()=>u._asyncData[l.value]?.error),refresh:(...e)=>{if(!u._asyncData[l.value]?._init){return createInitialFetch()()}return u._asyncData[l.value].execute(...e)},execute:(...e)=>f.refresh(...e),clear:()=>{const e=u._asyncData[l.value];if(e?._abortController)try{e._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{e._abortController=void 0}clearNuxtDataByKey(u,l.value)}},y=Promise.resolve(u._asyncDataPromises[l.value]).then(()=>f);return Object.assign(y,f),y}function writableComputedRef(a){return e.computed({get:()=>a()?.value,set(e){const t=a();t&&(t.value=e)}})}function clearNuxtDataByKey(a,t){t in a.payload.data&&(a.payload.data[t]=void 0),t in a.payload._errors&&(a.payload._errors[t]=void 0),a._asyncData[t]&&(a._asyncData[t].data.value=e.unref(a._asyncData[t]._default()),a._asyncData[t].error.value=void 0,a._asyncData[t].status.value="idle"),t in a._asyncDataPromises&&(a._asyncDataPromises[t]=void 0)}e.defineComponent({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(a,{slots:t,attrs:r}){const n=e.shallowRef(!1),s=e.getCurrentInstance();return s&&(s._nuxtClientOnly=!0),e.provide(o,!0),()=>{if(n.value){const a=t.default?.();return a&&1===a.length?[e.cloneVNode(a[0],r)]:a}const o=t.fallback||t.placeholder;if(o)return e.h(o);const s=a.fallback||a.placeholder||"",c=a.fallbackTag||a.placeholderTag||"span";return e.createElementBlock(c,r,s)}}});const getDefault=()=>{},getDefaultCachedData=(e,a,t)=>a.isHydrating?a.payload.data[e]:"refresh:manual"!==t.cause&&"refresh:hook"!==t.cause?a.static.data[e]:void 0;export{useAsyncData as u};
//# sourceMappingURL=asyncData-CuQFsPtm.mjs.map
